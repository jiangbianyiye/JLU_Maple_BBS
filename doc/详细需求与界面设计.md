### 技术需求 ###
框架：Spring+SpringMVC+MyBatis

### 界面规约 ###

#### 素材需求 ####

##### 图像 #####
- 网站Logo
- 用户头像（示意）
- 论坛头图（示意）
- 置顶主题标志，人气主题标志，一般主题标志

#### 所有页面 ####
- 显示页面头
  - 页面头的内容包括：网站Logo，导航
    - 网站Logo导航到根论坛的论坛页面
    - 导航包括到以下页面的链接：自己的用户页面(若当前用户为游客则显示为登录页面)，根论坛的论坛页面，搜索页面（若当前用户为游客则提示请先登录）

#### 注册页面 ####
- 用户名，邮箱，密码，确认密码的输入框，及各自的验证器
- 用户头像的选择器（示意，不可用）
- 提交按钮，注册成功后发出提示并导航到登录页面

#### 登录页面 ####
- 用户名，密码的输入框，及各自的验证器
- 确认按钮，登录成功后导航到用户页面
- 到注册页面的超链接

#### 用户页面 ####
- 用户头像（示意），用户名，用户状态的显示
- 若这用户页面是自己的用户页面，显示退出登录按钮和修改信息按钮；退出登录按钮在操作成功后导航到根论坛的论坛页面，修改信息按钮导航到用户信息修改页面
- 定制信息的显示
- 近期发言的显示
  - 关于每条近期发言显示发言所在的主题页面，发言的内容摘要（内容的前若干个文字），发言时间
- 若正在浏览页面的当前用户是版主及以上，显示禁言/取消禁言按钮
  - 版主的禁言时长最高为10天
  - 论坛管理员的禁言时长最高为99999天

#### 用户信息修改页面 ####
- 显示当前用户名
- 旧密码，新密码，新密码重复，邮箱，个性签名的输入框，及各自的验证器
- 用户头像的选择器（示意，不可用）
- 确认按钮，修改成功后发出提示并导航到用户页面

#### 论坛页面 ####
- 论坛头图（示意）
- 版主列表
  - 对每个版主，若当前用户是论坛管理员，显示解除按钮
  - 若当前用户是论坛管理员，显示指定版主按钮
- 置顶主题的列表
  - 关于每条主题，显示置顶主题标志，主题标题，楼主用户名，主题创建时间，点击量
  - 关于每条主题，若当前用户是版主及以上，显示取消置顶按钮
- 分论坛的列表
  - 关于每个分论坛，显示论坛名，版主
  - 关于每个分论坛，若当前用户是论坛管理员，显示删除按钮
  - 若当前用户是论坛管理员，显示创建分论坛按钮
- 其他主题的列表
  - 关于每条主题，显示人气主题标志或一般主题标志，主题标题，楼主用户名，主题创建时间，最后回复用户的用户名，最后回复时间，点击量
  - 关于每条主题，若当前用户是版主及以上，显示删除按钮和置顶按钮
- 翻页器
- 论坛网站的在线用户列表

#### 分论坛创建页面 ####
- 显示要创建的那个分论坛的父论坛的名字
- 论坛名的输入框和验证器
- 论坛头图的选择器（示意，不可用）
- 确认按钮，创建成功后导航到父论坛的论坛页面

#### 主题页面 ####
- 主题表头
  - 包含主题标志（置顶主题标志/人气主题标志/一般主题标志），主题标题，点击量
  - 若当前用户是版主及以上，显示删除按钮和置顶/取消置顶按钮
- 楼层的列表
  - 关于每个楼层，显示发言用户头像（示意），发言用户的用户名，发言内容，发言用户的个性签名，发言时间，楼层号
  - 若那个楼层是自己的，显示修改和删除按钮；修改按钮导航到发言修改页面，删除按钮在操作成功后发出提示并导航到主题页面
  - 若楼层被修改过，显示最近修改时间
- 翻页器
- 发言框
  - 只能发送文字内容
- 发言确认按钮，发言成功后发出提示并导航到主题页面
  - 若自己正在禁言中则提示无法发言

#### 发言修改页面 ####
- 发言框
  - 只能发送文字内容
- 发言确认按钮，发言成功后发出提示并导航到主题页面
  - 若自己正在禁言中则提示无法发言

#### 搜索页面 ####
- 按用户名搜索用户的用户名输入框
- 按用户名搜索用户的确认按钮
- 按主题标题搜索主题的主题标题输入框
- 按主题标题搜索主题的确认按钮

#### 搜索结果页面 ####
- 条目显示
  - 每个条目只包含一个前往页面的链接和文字摘要
    - 搜索用户时，前往页面的链接导航到用户页面，链接文字为用户名，文字摘要为那个用户的个性签名
    - 搜索主题时，前往页面的链接导航到主题页面，链接文字为主题标题名，文字摘要为主题的1楼的内容摘要
- 翻页器


### 详细用例 ###

##### U1.1 注册 #####
```
新建一个账户。
适用角色：游客
前置：注册页面，提交时
事件流：
1.验证用户输入是否满足约束：用户名(1~18)，密码(6~18，字母与数字组合)，邮箱(1~36)
2.网页将用户输入提交到服务器
3.1若用户名重复，进入异常流，网页提示该用户名已被注册
3.2否则服务器在数据库中建立该用户数据，网页提示注册成功
后置：若注册成功，导航到登录页面
```

##### U1.2 登录 #####
```
登录账户，将用户角色从游客改变为注册用户及以上。
适用角色：游客
前置：登录页面，提交时
事件流：
1.网页将用户输入的用户名和密码提交到服务器
2.1若用户名密码不和数据库中内容一致，进入异常流，网页提示用户名或密码错误
2.2否则网页提示登录成功
后置：若登录成功，导航到登录用户的用户页面
```

##### U2.1 退出登录 #####
```
注销登录，显式终止和服务器的对话。
适用角色：注册用户及以上
前置：用户页面，选择退出登录时
事件流：
1.若存在对话，服务器终止对话
2.网页提示退出登录成功
后置：返回登录页面
```

##### U2.2 发言 #####
```
在查看主题页面时在主题的最末加入含有自己发言的新的楼层。
适用角色：注册用户及以上
前置：主题页面，点击发送发言时
事件流：
1.验证器检查（字数是否超标等）
2.1若此用户当前正在禁言中：进入异常流，网页提示当前用户正在被禁言，无法发言
2.2否则继续以下
3.服务器将发言信息以楼层的形式插入到楼层数据库中，并在主题和楼层的关系表内也加入对应项，将主题的"下一楼层号"加一
4.网页提示发表成功
后置：刷新页面
```

##### U2.3 修改发言 #####
```
在查看主题页面时修改自己的楼层。
适用角色：注册用户及以上
前置：主题页面，点击自己发言上的修改发言按钮时
事件流：
1.验证器检查（字数是否超标等）
2.1若此用户当前正在禁言中：进入异常流，网页提示当前用户正在被禁言，无法修改
2.2否则继续以下
3.在网页上渲染一个文字框内容为已有发言，让用户能够进行修改其中内容
4.确认后服务器将对应楼层实体的发言信息修改
5.网页提示发表成功
后置：刷新页面
```

##### U2.4 删除发言 #####
```
在查看主题页面时删除自己的楼层。
适用角色：注册用户及以上
前置：主题页面，点击自己发言上的修改发言按钮时
事件流：
1.网页提示"是否真的要删除该楼层？"
2.确认后服务器将主题与楼层的关系表中对应的关系删除，将对应楼层实体删除
3.网页提示删除成功
后置：刷新页面
```

##### U2.5 修改用户信息 #####
```
在查看用户信息修改页面时提交修改个人信息。
适用角色：注册用户及以上
前置：用户信息修改页面，显示的用户为自己，提交修改个人信息按钮时
事件流：
1.各验证器进行验证
2.服务器修改对应用户实体的资料
3.网页提示修改成功
后置：返回自己的用户信息页面
```

##### U2.6 搜索 #####
```
在搜索页面提交搜索关键字。
适用角色：注册用户及以上
前置：搜索页面，提交搜索按钮时
事件流：
1.验证器进行验证（搜索的关键字非空，等等）
2.网页导航到搜索结果页面，服务器将搜索的结果渲染到结果页面
```

##### U3.1 删除主题 #####
```
适用角色：版主及以上
前置：查看论坛页面，选择一个主题上的删除按钮时；或，查看主题页面，选择其上的删除按钮时
事件流：
1.网页提示"是否真的要删除？"
2.确认后服务器将主题与论坛的关系表中对应的关系删除，将对应主题实体删除
3.网页提示删除成功
后置：刷新页面
```

##### U3.2 置顶/取消置顶主题 #####
```
适用角色：版主及以上
前置：查看论坛页面，选择一个主题上的置顶/取消置顶按钮时；或，查看主题页面，选择其上的置顶/取消置顶按钮时
事件流：
1.服务器修改主题与论坛的关系表中对应的此关系中的置顶属性
2.网页提示操作成功
后置：刷新页面
```

##### U3.3.1 禁言用户 #####
```
令一个用户在一定时间内无法发言或修改发言
适用角色：版主及以上
前置：查看用户页面，选择禁言按钮时
事件流：
1.网页弹出表单面板，指定要禁言的时长（版主操作时，最多为10天；论坛管理员操作时，最多为99999天）
2.服务器修改对应用户实体的被禁言开始时间属性和被禁言时长属性
3.网页提示操作成功
后置：刷新页面
```

##### U3.3.2 取消禁言用户 #####
```
适用角色：版主及以上
前置：查看用户页面，选择取消禁言按钮时
事件流：
1.网页提示"是否真的取消禁言？"
2.服务器修改对应用户实体的被禁言开始时间属性到空
3.网页提示操作成功
后置：刷新页面
```

##### U4.1 创建分论坛 #####
```
适用角色：论坛管理员
前置：查看论坛页面，选择创建分论坛按钮时
事件流：
1.网页弹出表单面板，指定要创建的分论坛的属性
2.验证器进行验证（论坛名字数限制等）
3.服务器在论坛表格中新建实体，并在论坛到子论坛关系表中添加对应关系
4.网页提示操作成功
后置：导航到新创建的分论坛页面
```

##### U4.2 删除分论坛 #####
```
适用角色：论坛管理员
前置：查看论坛页面，对一个分论坛选择删除分论坛按钮时
事件流：
1.网页弹出"是否真的要删除此分论坛？"
2.再次警告"删除此分论坛后，此分论坛中所有的主题和楼层都无法恢复！是否真的要删除此分论坛？"
3.确认后服务器在论坛表格中删除对应的论坛实体，并级联删除此论坛中的所有主题和楼层
4.网页提示操作成功
后置：刷新页面
```

##### U4.3.1 指定版主 #####
```
指定一个用户，赋予其关于某一论坛的管理权限，使其能够置顶/取消置顶/删除论坛的主题等。
适用角色：论坛管理员
前置：查看论坛页面，选择指定版主按钮时
事件流：
1.网页弹出表单面板，输入要接受权限的那个用户的用户名
2.确认后服务器修改论坛表格中对应实体的版主域，加入那个用户
3.网页提示操作成功
后置：刷新页面
```

##### U4.3.2 解除版主 #####
```
适用角色：论坛管理员
前置：查看论坛页面，对某一版主选择取消版主时
事件流：
1.网页提示"是否要解除那个用户的版主职务？"
2.确认后服务器修改论坛表格中对应实体的版主域，移除那个用户
3.网页提示操作成功
后置：刷新页面
```


